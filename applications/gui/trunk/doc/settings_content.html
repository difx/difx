<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta content="text/html; charset=windows-1252"
      http-equiv="Content-Type">
    <title>Settings Window</title>
    <link type="text/css" rel="stylesheet" href="style.css">
  </head>
  <body>
    <h1>DiFX GUI System Settings Window</h1>
    The DiFX GUI System Settings window contains all user-editable
    parameters that control the configuration and appearance of the GUI,
    as well as its communication with the core DiFX software.&nbsp; The
    System Settings are organized in a browse-able hierarchy of
    "sub-topic" panels that can be opened and closed as needed.&nbsp;
    Sub-topic panels include:<br>
    <ul>
      <li><a href="#SETTINGS_FILE">Settings File</a></li>
      <li><a href="#DiFX_Control_Connection">DiFX Control Connection</a><br>
      </li>
      <li><a href="#Broadcast_Network">DiFX Mulitcast Messages</a></li>
      <li><a href="#Database_Configuration">Database Configuration</a></li>
      <li>Documentation Locations</li>
    </ul>
    <h2><a name="SETTINGS_FILE"></a>Settings File</h2>
    <p>When the GUI is started it attempts to read an XML file
      containing settings for all GUI parameters, window configurations,
      etc.&nbsp; This file can either be specified as the first command
      line argument when starting the GUI or a default file will be used
      (the default file is "conf/guiSettings.xml" under the directory
      specified by the environment variable "DIFXROOT", or, failing
      that, the user's directory).&nbsp; Failing to read either a
      specified file or the default file will cause internal default
      settings to be used which may or may not be attractive.&nbsp; When
      the GUI is exited the default XML file is written to reflect the
      GUI's current state such that it can be started again in the
      future essentially unchanged from where it was left.&nbsp;
      Failures to read or write files will generate pop-up warnings, but
      won't terminate the GUI's operation.<br>
    </p>
    <p>The Settings File section of the Settings Window can be used to
      pick a new XML file name for reading or writing.&nbsp; This can be
      useful if you want to save a specific GUI state for later use or
      load a previously saved state:<br>
      <br>
    </p>
    <p align="center"><img alt=""
        src="images/settings/settings_file.png" height="78" width="700"><br>
    </p>
    <div align="left">
      <h5>Current</h5>
      <p>This field shows the full path to the XML file that was most
        recently read, either a user-specified file or the default.&nbsp; If
        this field is in red it indicates that the last read attempt
        failed for some reason and that whatever settings that existed
        previously are still in place.&nbsp; <br>
      </p>
      <h5>Open</h5>
      <p>Open can be used to open an existing XML file that contains GUI
        settings.&nbsp; A file browser will allow the file to be picked.<br>
      </p>
      <h5>Save</h5>
      <p>Save causes the current GUI settings to be written to the XML
        path in the "Current" field.<br>
      </p>
      <h5>Save As...</h5>
      <p>This button produces a file browser from which a path for the
        XML file can be picked.&nbsp; The XML file is written
        immediately.<br>
      </p>
      <h5>Defaults</h5>
      <p>The Defaults button will restore the GUI to internal
        defaults (not the default XML file settings).&nbsp; <br>
        <br>
      </p>
    </div>
    <h2><a name="DiFX_Control_Connection"></a>DiFX Control Connection</h2>
    <p>The DiFX Control Connection settings determine how the GUI
      communicates with and controls DiFX.&nbsp; In normal operation the
      GUI makes a TCP connection with the <span style="font-style:
        italic;">guiServer</span> process running on the DiFX "Host"
      node.&nbsp; To complicate matters however, there are actually
      three ways the GUI and DiFX can interact:<br>
    </p>
    <ol>
      <li>The TCP connection between the GUI and <span
          style="font-style: italic;">guiServer</span> is used for all
        controls and data exchanges.&nbsp; DiFX multicast message
        traffic is collected by <span style="font-style: italic;">guiServer</span>
        and relayed over the TCP socket to the GUI (for more information
        about message traffic, see the <a href="#Broadcast_Network">DiFX









          Multicast Messages</a> section below).&nbsp; This
        configuration must be used when the GUI is running outside the
        DiFX LAN, such that the multicast messages cannot be received
        directly.&nbsp; It is far and away the most tested
        configuration, and should be used if possible.<br clear="all">
        <br>
      </li>
      <li>The TCP connection between the GUI and <span
          style="font-style: italic;">guiServer</span> is used for
        controls and all data from <span style="font-style: italic;">guiServer</span>
        itself, however DiFX multicast messages are received directly
        using a UDP socket.&nbsp; Under some circumstances this could be
        the preferred arrangement when the GUI is running on the DiFX
        LAN where multicast messages are received as it reduces <i>guiServer</i>
        network traffic and allows the GUI to monitor things even if <i>guiServer</i>
        is for some reason lost.<br>
        <br>
      </li>
      <li>No connection is made to <i>guiServer</i>.&nbsp; The GUI
        receives DiFX multicast messages directly using a UDP socket,
        essentially acting as a monitor of DiFX activity.&nbsp; The GUI
        can also issue some commands directly to DiFX using its own
        multicast messages, but the command set available is limited and
        in the long run this capability will not be supported.<br>
      </li>
    </ol>
    The DiFX Control Connection panel includes settings that will
    determine in which of the above modes your GUI will interact with
    DiFX, as well as port and version specifications.&nbsp; Details
    about each control/display item are outlined below.<br>
    <br>
    <div style="text-align: center;"><img style=" width: 902px; height:
        243px;" alt="" src="images/settings/DifxControlConnection.png"
        height="191" width="700"><br>
    </div>
    <br>
    <ul>
      <li> <a href="#MulticastguiServer_Check_Boxes">Multicast/guiServer
          Check Boxes</a></li>
      <li><a href="#guiServer_Connection_Light">guiServer Connection
          Light</a></li>
      <li><a href="#DiFX_Host">DiFX Host</a></li>
      <li><a href="#Control_Port">Control Port</a></li>
      <li><a href="#TRANSFER_PORTS">Transfer Port and Max Open Ports</a></li>
      <li><a href="#Monitor_Host_and_Port">Monitor Host and Port</a></li>
      <li><a href="#guiServer_Version_">guiServer Version</a></li>
      <li><a href="#built_wDiFX">built w/DiFX</a></li>
      <li><a href="#Host_Environment_Vars">Host Environment Vars</a></li>
      <li><a href="#Username_">Username</a></li>
      <li><a href="#DiFX_Base">DiFX Base</a></li>
      <li><a href="#Run_wDiFX_Version">Run w/DiFX Version</a></li>
      <li><a href="#Use_Default_Start_Script">Use Default Start Script</a><br>
      </li>
      <li><a href="#DiFX_Execute_Script">DiFX Execute Script</a><br>
      </li>
    </ul>
    <h5><a name="MulticastguiServer_Check_Boxes"></a>Multicast/guiServer
      Check Boxes</h5>
    <p>These check boxes determine how the GUI communicates with DiFX,
      either through direct multicast messaging (unsupported,
      incomplete, and unlikely to work very well) or via direct TCP
      connection to <i>guiServer</i> (preferred, obviously).&nbsp; You
      will almost always want to use the <i>guiServer </i>option - the
      Multicast option exists for historical reasons and is maintained
      because it has some utility in testing.<br>
    </p>
    <h5><a name="guiServer_Connection_Light"></a>guiServer Connection
      Light</h5>
    <p>The guiServer Connection light gives an immediate indication
      whether a healthy TCP connection exists between the GUI and <i>guiServer</i>.&nbsp;
      A green light means a good connection.&nbsp; Red means a broken
      connection.&nbsp; A yellow light occurs when the GUI has some
      concern about the connection (these usually turn red quickly) or
      that a connection is in the process of being made (these usually
      turn green quickly).<br>
    </p>
    <h5><a name="DiFX_Host"></a>DiFX Host</h5>
    This is the hostname of the node on which <i>guiServer</i> is
    running, or will run.&nbsp; Changes to this field will trigger a
    reconnection attempt for the TCP link between the GUI and <i>guiServer</i>
    (the GUI will continue to try to make the connection until it
    works).&nbsp; This name should be recognizable by the nameserver on
    the host where you are running the GUI (you can also use IP
    addresses in this field).<br>
    <h5><a name="Control_Port"></a>Control Port</h5>
    This is the port for TCP control communications between the GUI and
    <i>guiServer</i>.&nbsp; Its default value it is the same as the Port
    setting under Broadcast Network (50200), but this similarity is of
    no significance (and, in hindsight, is purposelessly
    confusing).&nbsp; Changes to the control port will cause a new TCP
    connection attempt.&nbsp; When you start <i>guiServer</i>, it
    reports the port number where it expects connections - that is what
    you should use here.<br>
    <h5><a name="TRANSFER_PORTS"></a>Transfer Port and Max Open Ports<br>
    </h5>
    <p>The <b>Transfer Port</b>&nbsp; and <b>Max Open Ports</b>
      determine the port numbers that will be used to transmit data from
      <i>guiServer</i> to the GUI.&nbsp; The GUI often has cause to
      request sets of data from the <i>guiServer</i> - the contents of
      files, directory listings, etc. - that are then transmitted using
      quick TCP connections that are opened as necessary and closed when
      no longer needed.&nbsp; Whenever such a request is made it is
      accompanied by a unique port number that is then used by <i>guiServer</i>
      for the data transfer.&nbsp; The Transfer Port number specified
      here is a "base" number that is used to form the unique port
      numbers - port numbers increment from this base up to (Transfer
      Port + Max Open Ports), and then recycle at the Transfer Port
      number.&nbsp; Locking mechanisms assure that port numbers aren't
      reused until they have been closed.&nbsp; <br>
    </p>
    <p>The user probably doesn't need to worry about these numbers much,
      except to make sure there are no port restrictions that apply to
      the range defined, and that the range is big enough.&nbsp; If file
      transfers appear to be slow (pop-up monitors of file transfers
      will let you know this) or to occasionally stall completely it is
      possible that increasing Max Open Ports will help you, although it
      is critical that Max Open Ports <i>not be changed when any ports
        are in use</i>.<br>
    </p>
    <h5><a name="Monitor_Host_and_Port"></a>Monitor Host and Port</h5>
    <p>The Monitor Host and Port are used to specify the connection to
      the <i>difx_monitor</i> server.&nbsp; This is a process that
      provides real-time data feedback that can be used to monitor a
      running job.&nbsp; The documentation on the <a
        href="realtime_monitor.html">Real-Time Job Monitor</a> has more
      detail about this.<br>
    </p>
    <p> </p>
    <h5><a name="guiServer_Version_"></a>guiServer Version </h5>
    <p>The "guiServer Version" is a version number in a version scheme
      that is specific to <i>guiServer</i>.&nbsp; It should match the
      version number of the GUI itself to assure that they are
      compatible, however there is no need for it to match the DiFX
      version (in general it won't).&nbsp; This is not a field the user
      can change - it is reported by <i>guiServer</i> when a new TCP
      connection is made.<br>
    </p>
    <h5><a name="built_wDiFX"></a>built w/DiFX</h5>
    <p>This field shows the version of the DiFX software that was used
      to build the <i>guiServer</i>.&nbsp; <i>GuiServer</i> depends on
      a number of DiFX header files and libraries (primarily for file
      parsing) when it builds so in a perfect world it would match the
      "Run w/DiFX Version" (see below).&nbsp; However this is not, in
      general, critical, as the file parsing libraries a fairly stable
      (and almost always backward compatible) between DiFX
      versions.&nbsp; This field cannot be changed by the user.&nbsp; It
      will be filled automatically when a TCP connection is made.<br>
    </p>
    <h5><a name="Host_Environment_Vars"></a>Host Environment Vars</h5>
    <p>The "Host Environment Vars" button creates a display of DiFX Host
      environment variables as seen by <i>guiServer</i>:<br>
    </p>
    <p align="center"><img alt=""
src="file:///Users/johnspitzak/difx/applications/gui/trunk/doc/images/settings/EnvironmentVars.png"
        height="387" width="687"><br>
    </p>
    <div align="left">All environment variables regardless of their
      applicability can be displayed, or only those that apply to DiFX
      may be selected (at the moment this distinction is determined
      rather simplistically - by whether or not "DIFX" is the first four
      characters in the variable name, but this capability may be made
      more sophisticated in the future).&nbsp; The settings of
      environment variables can be used to determine how several GUI
      options should be set.<br>
    </div>
    <h5><a name="Username_"></a>Username<br>
    </h5>
    This field shows the name of the user under which <i>guiServer</i>
    was started.&nbsp; All DiFX processes that <i>guiServer</i> starts
    will also be run under this user (which means the username must have
    permission to do so on the host running <i>guiServer</i>).<br>
    <h5><a name="DiFX_Base"></a>DiFX Base</h5>
    <p>The "DiFX Base" is a path on the DiFX host under which the DiFX
      software resides.&nbsp; The DiFX Base is actually just one of the
      environment variables (see above) found on the DiFX host.&nbsp;
      Below this directory will be "bin" directories and source
      directories for each installed DiFX version.<br>
    </p>
    <h5><a name="Run_wDiFX_Version"></a>Run w/DiFX Version</h5>
    <p>The GUI does a number of things, such as organizing jobs and
      creating/administering job data directories.&nbsp; But primarily
      its purpose is to run DiFX, which it does for the most part by
      executing DiFX applications on the DiFX host through system level
      commands (equivalent to command line operations).&nbsp; The "Run
      w/DiFX Version" setting can be used to instruct <i>guiServer</i>
      to use a specific version of the DiFX application.&nbsp; A
      pull-down menu will provide all of the DiFX software versions
      installed on the DiFX host.<br>
    </p>
    <p>Note that this setting can be changed <i>at any time</i> during
      the process of running a job, such that you can run some DiFX
      applications using one version of DiFX, and others using
      another.&nbsp; For instance, if you want to use the latest
      development version of the software to run <i>mpifxcorr</i>, but
      know that your data require <i>vex2difx</i> from version 2.1, <i>and</i>
      you know what you are doing, you can change this setting at
      different stages in the process accordingly.&nbsp; Which is not to
      say this is recommended behavior.<br>
    </p>
    <h5><a name="Use_Default_Start_Script"></a>Use Default Start Script</h5>
    <p>Use the chosen DiFX Version name to produce a default value for
      the DiFX Execute Script but appending to version name to
      "rungeneric.".&nbsp; This will cause the DiFX Execute Script to be
      over-written.<br>
    </p>
    <h5><a name="DiFX_Execute_Script"></a>DiFX Execute Script<br>
    </h5>
    The DiFX Execute Script is a script used by guiServer to execute all
    DiFX commands (both those run locally on the DiFX host and via <i>mpirun</i>
    on other nodes).&nbsp; The execute script can be used to do any set
    up or environment variable definition that must take place for DiFX
    processes to run correctly.&nbsp; For instance, if you are running <i>vex2difx</i>,
    which is run on the DiFX host, and you have the DiFX execute script
    defined as <i>rungeneric.DIFX_DEVEL</i>, guiServer will execute the
    command:<br>
    <pre><tt>	</tt>rungeneric.DIFX_DEVEL vex2difx [args...]</pre>
    When running <i>mpifxcorr</i>, which uses <i>mpirun</i> to run on
    multiple nodes, <i>guiServer</i> will run the following:<br>
    <pre>	mpirun [args...] rungeneric.DIFX_DEVEL mpifxcorr [more args...]</pre>
    In the former case the execute script is run on the DiFX host (where
    <i>guiServer</i> is being run) while in the latter case it is run on
    each of the nodes in the cluster accessible to <i>mpirun</i>.&nbsp;
    In all cases, the node involved must be able to execute the named
    script.<br>
    <br>
    If you do nothing, guiServer will choose "rungeneric.[DiFX Version]"
    as a default name for the execute script (Walter Brisken's <i>difxbuild</i>
    procedure will automatically create this script for each DiFX
    version that it builds).&nbsp; You can, however, put anything in
    this field that you want, including nothing at all.&nbsp; The
    contents of the field is inserted as a string in the commands
    (examples just above) before they are executed.<br>
    <br>
    Note that because the script is run on each node you can actually
    have a different script on each node doing different things, as long
    as they all share the same name.<br>
    <h2><a name="Broadcast_Network"></a>DiFX Multicast Messages</h2>
    DiFX uses UDP multicast messages to periodically broadcast the
    status of individual nodes and the state of running jobs -
    information the user interface displays.&nbsp; The messages
    originate (with some exceptions) from the <i>mk5daemon</i> process
    that should be running on each node in the DiFX cluster.&nbsp; This
    same multicast system is used by the user interface (either through
    <i>guiServer</i> or directly) <span style="font-style: italic;"></span>to






    communicate with <span style="font-style: italic;">mk5daemon</span>
    and control the components of the software correlator.&nbsp; <br>
    <br>
    <div align="center"><img alt=""
        src="images/settings/multiMessages.png" height="214" width="900"><br>
      <div align="left">
        <ul>
          <li><a href="#Relay_Using_guiServer_Connection_">Relay Using <i>guiServer</i>
              Connection</a></li>
          <li><a href="#Group_Address">Group Address</a></li>
          <li><a href="#Port">Port</a></li>
          <li><a href="#Buffer_Size">Buffer Size</a></li>
          <li><a href="#Timeout_ms">Timeout</a></li>
          <li><a href="#Packet_Traffic_Plot">Packet Traffic</a></li>
          <li><a href="#Suppress_Unknown_Message_Warnings">Suppress
              "Unknown Message" Warnings</a></li>
          <li><a href="#View_DiFX_Messages">View DiFX Messages</a></li>
          <li><a href="#Identify_Mark5_Unit_Names_by_Pattern">Identify
              Mark5 Unit Names by Pattern</a></li>
          <li><a href="#Inactivity_WarningError_Settings">Inactivity
              Warning/Error</a><br>
          </li>
        </ul>
      </div>
    </div>
    <h4><a name="Relay_Using_guiServer_Connection_"></a>Relay Using <i>guiServer</i>
      Connection<br>
    </h4>
    Being based on UDP, the multicasts will only work within a local
    area network.&nbsp; However, if you are connecting to the <span
      style="font-style: italic;">guiServer</span> to control DiFX you
    can elect this option to "relay" all multicast messages through the
    TCP connection between the user interface and <span
      style="font-style: italic;">guiServer</span>.&nbsp; All messages
    on the DiFX subnet are collected by <span style="font-style:
      italic;">guiServer</span> and retransmitted to the user interface
    where they are parsed and displayed exactly as if the user interface
    were on the subnet.&nbsp; This option is only available if the DiFX
    Control Connection is set to "guiServer" (see above).<br>
    <h4><a name="Group_Address"></a>Group Address</h4>
    This address is used to identify the UDP multicast "group" that <span
      style="font-style: italic;">mk5daemon</span> is using.&nbsp; It
    should match the DIFX_MESSAGE_GROUP environment variable setting
    used when starting <span style="font-style: italic;">mk5daemon</span>
    on all processing and data source nodes (run <span
      style="font-style: italic;">mk5daemon</span> with the "-h" option
    for details).&nbsp; At the moment the default value for this
    environment variable, and thus the setting you should probably use
    here, is "224.2.2.1".&nbsp; This setting has no impact if messages
    are being relayed from <i>guiServer</i>.
    <h4><a name="Port"></a>Port</h4>
    The port is used for UDP multicasts.&nbsp; This should match the
    value of the DIFX_MESSAGE_PORT environment variable in place when <span
      style="font-style: italic;">mk5daemon</span> was started on each
    node.&nbsp; At the moment the default value for the environment
    variable, and thus this field, is 50200.&nbsp; This setting has no
    impact if messages are being relayed from <i>guiServer</i>.<br>
    <h4><a name="Buffer_Size"></a>Buffer Size</h4>
    This is the maximum size of a broadcast message, in bytes.&nbsp;
    Probably this shouldn't be fiddled with too much - making it too
    small will cause UDP messages to be incompletely read.&nbsp; It is a
    block of memory that must be allocated for each incoming message, so
    it shouldn't be huge either.&nbsp; <br>
    <h4><a name="Timeout_ms"></a>Timeout (ms)</h4>
    The timeout is the number of milliseconds that the system will wait
    for an incoming broadcast message.&nbsp; It can be set to 0, which
    means "wait forever", although this might be unhealthy (killing the
    thread that reads messages will become difficult).&nbsp; Otherwise
    it does little more than govern the update rate of the Packet
    Traffic Plot (see below).<br>
    <h4><a name="Packet_Traffic_Plot"></a>Packet Traffic Plot</h4>
    The Packet Traffic Plot shows all received DiFX messages as they are
    read in real time.&nbsp; If you are receiving messages (i.e. all of
    the above settings are set properly) this should have a heartbeat
    appearance - there should be occasional spikes as messages come in
    (the height of the spikes is the size of messages relative to the
    Buffer Size).&nbsp; If, on the other hand, you get a "flat line",
    your settings are wrong, or <span style="font-style: italic;">mk5daemon</span>
    isn't running anywhere visible on the local area network.<br>
    <br>
    Below is a "healthy" Packet Traffic Plot showing a series of UDP
    messages over time:<br>
    <img style=" width: 302px; height: 124px;" alt=""
      src="images/settings/good_packet_traffic_plot.gif"><br>
    <br>
    <h4><a name="Suppress_Unknown_Message_Warnings"></a>Suppress
      "Unknown Message" Warnings</h4>
    <p>This check box was put in place to avoid annoying error messages
      during development and is largely obsolete.&nbsp; It will probably
      be removed in the near future.<br>
    </p>
    <h4><a name="View_DiFX_Messages"></a>View DiFX Messages</h4>
    <p>The "View DiFX Messages" button will bring up the "DiFX Message
      Traffic Monitor".&nbsp; This window lists all (recognized) DiFX
      message types that are received by the GUI (either directly via
      UDP, for relayed from the <i>guiServer</i>), displays their "raw"
      XML code, and parses them according to their type.&nbsp; A buffer
      of messages is stored.&nbsp; Users can select the types of
      messages they wish to see, examine any message in the buffer, and
      change the buffer size.&nbsp; Originally created for diagnostic
      purposes, this window provides a view into DiFX inter-process
      communication that may be useful, or at least amusing.</p>
    <p align="center"><img alt=""
        src="images/settings/trafficMonitor.png" height="670"
        width="900"><br>
    </p>
    <p> </p>
    <h4><a name="Identify_Mark5_Unit_Names_by_Pattern"></a>Identify
      Mark5 Unit Names by Pattern</h4>
    <p>This check box and text field cause the GUI (primarily in the
      Hardware Monitor Window) to determine whether multicast messages
      are from Mark 5 Nodes or Processor Nodes based on machine
      names.&nbsp; If the box is checked the machine name of the source
      of each message is compared to a list of comma-separated "regular
      expressions" contained in the text field.&nbsp; If it matches any
      one of them, the message is assumed to be from a Mark 5 unit and
      is sorted accordingly.<br>
    </p>
    <p>Regular expressions are extremely useful for pattern matching,
      but if you haven't used them before they can be less than 100%
      intuitive.&nbsp; There are many online resources that explain them
      in excruciating detail.&nbsp; The default value for patterns
      "mark5.*" matches the NRAO practice (duplicated at USNO) of naming
      all Mark 5 machines such that they start with the five characters
      "mark5", as in "mark5-101.foo.edu".</p>
    <h4><a name="Inactivity_WarningError_Settings"></a>Inactivity
      Warning/Error Settings</h4>
    <p>The Hardware Monitor Window lists all processors and Mark 5
      Modules on the LAN that are broadcasting <i>mkdaemon</i>
      messages.&nbsp; Associated with each processor or module is an
      "activity" light that turns green briefly whenever a new message
      for that processor or module is received from <i>mk5daemon</i>
      (these messages should be transmitted periodically if all is
      working correctly).&nbsp; To alert the user when a processor or
      module has <i>not</i> been heard from in a while, the light will
      turn yellow after the "Warning" number of seconds have elapsed
      with no received message.&nbsp; The light will turn red after the
      "Error" number of seconds.<br>
    </p>
    <p>These <a href="widgets_content.html#Number_Boxes">Number Box</a>
      settings let you change the number of seconds that elapse without
      messages before the lights change.&nbsp; They should be adjusted
      to what works for your installation.<br>
      <br>
    </p>
    <ul>
    </ul>
    
    <h2><a name="Job Settings"></a>Job Settings</h2>

    The Job Settings govern how individual jobs are run, both when started directly by
    the user and when automatically run by the scheduler.  
    
    <h3>Data Source Defaults</h3>
    
    <h3>Processing Defaults</h3>
    
    <h3>Scheduler Settings</h3>
    
    Scheduler Settings govern the operation of the job scheduler.  The job scheduler can be set to run a large
    number of jobs automatically.  For details on running jobs using the scheduler, see BLAT.
    
    <h3>Run Log Settings</h3>
    
    The GUI is designed to collect information about every job that is run.  The purpose of this, as designed at
    least, is to generate statistics that allow the user, or possibly the GUI itself (if it ever gets that so
    clever) to determine the "best" way to run jobs in the future.  The log may have other purposes as well.
    
    The run log is meant to be (mostly) invisible during regular use.  It will grow continuously, and consume
    disk space in doing so.  If this proves annoying, run logging can be shut off at the cost of losing any information
    the run log contains.
    
    <h5>Log Run Data</h5>
    
    This is a simple check box that turns logging on and off.
    
    <h5>Run Log File</h5>
    
    The name of the run log file is by default ".difxGuiRunLog", in the user's home directory.  Changing the name
    of the file will essentially create a new log file, as the log data for each run operation is simply appended
    to the run log file name specified here.gui
    
    <h5>Analyzing Run Log Data</h5>
    
    The run log data are stored in XML format - not especially human readable, but flexible and easy for the GUI
    to read and write.  For each job that is run, they contain the following information (XML keyword and variable type
    in parenthesis):
    <ul>
        <li><b>Active ID</b> ("active_id" - long): This is a unique long integer identifier assigned to the job - current the
            data nd time of the run in milliseconds since January 1, 1970.
        <li><b>Date/Time</b> ("time" - double): Start time of the job in seconds since January 1, 1970.
        <li><b>Input File</b> ("inputFile" - string): Full path (as the head node sees it) to the input file associated with the job.
            The input file contains detailed information about the job - if it is deleted you will lose that.
        <li><b>Baselines</b> ("baselines" - int): Number of baselines in the job.
        <li><b>Total Scan Data Measurement?</b> (scan_time): Some way of measuring the total processing volume that is required.
            Not sure what this is yet.
        <li><b>Scans</b> ("scans" - int): Number of scans in the job.
        <li><b>Head Node</b> ("headnode" - string): Name of the head node used.
        <li><b>Source Nodes</b> ("sourceNodes"): List of the source nodes used in the job.  Each item contains the following:
            <ul>
                <li><b>Source Node</b> ("node" - string): Node name of the source.
                <li><b>Threads</b> ("threads" - int): Number of threads used for data.
            </ul>
        <li><b>Processing Nodes</b> ("processingNodes"): List of the nodes used for processing.  Each item has:
            <ul>
                <li><b>Processing Node</b> ("node" - string): Node name of processor.
                <li><b>Threads</b> ("threads" - int): Number of threads used for processing.
            </ul>
        <li><b>Other Active IDs</b> ("activeIDs"): A list of the other jobs that were running at some point during the
            processing of this job.
        <li><b>Total Time</b> ("totalTime" - double): The "wall clock" time used to process the job.  This is a measure of how
            fast it ran for the user under the conditions it was subject to (other processes running, etc.).
        <li><b>Final State</b> ("state" - string): The "state" that the job terminated in - completed, failed, whatever.
        <li><b>DiFX Version</b> ("difxVersion" - string): Version of DiFX used for the processing.
    </ul>
    
    Because the run log is in development and it isn't certain what its final use will be, each entry is contained in
    a "wrapper" that identifies the GUI version used to create it.  This will allow changes to be made to the logged
    data in the future, if that proves necessary, without rendering existing data useless.  This wrapper looks like
    this:
    <ul>
        <li><b>GUI Version</b> (gui_version): Version of the GUI used to run the job, and generate the XML.
        <li><b>Job Data</b> (data): This contains the complete list of XML items above.
    </ul>
    
    <h2><a name="Database_Configuration"></a>Database Configuration</h2>
    Database trouble?&nbsp; See <a
      href="#Testing_the_Database_Configuration"><span
        style="font-style: italic;">Trouble-shooting the Database
        Configuration</span></a>.<br>
    <br>
    The Database Configuration settings control the access the GUI has
    to the DiFX database.&nbsp; The DiFX database contains settings and
    status for experiments, passes, and jobs that appear in the Queue
    Browser window.&nbsp; The GUI remotely accesses the database using a
    network connection (the database can also be consulted on the
    command line by running a client program either remotely or on the
    DiFX database host).&nbsp; The following fields govern the GUI's
    remote access to the database:<br>
    <h4>Use Data Base</h4>
    This checkbox determines whether the GUI is using the database at
    all.&nbsp; If checked, changes to experiments, passes, and jobs in
    the Queue Browser will be reflected in the database, and items in
    the database will appear in the Queue Browser.&nbsp; If not,
    experiments, passes, and jobs will only appear in the Queue Browser
    if they are created by the same instance of the GUI - any
    information about them will be lost if the GUI is shut down and
    restarted.&nbsp; Beyond this capability, the database is not
    required - the GUI will still be able to run DiFX without it.<br>
    <h4>Version</h4>
    <p>The version field is not currently in use, but may be used in the
      future to coordinate the GUI with changes that may be made to the
      database structure.&nbsp; It is set to the most recent version of
      the database that the GUI can properly parse (at the moment this
      is the <span style="font-style: italic;">only</span> version is
      can parse).&nbsp; Changing it will have no effect.<br>
    </p>
    <h4>Host</h4>
    The database Host is the hostname of the host that contains the DiFX
    database.&nbsp; The named host should be accessible through normal
    network connections, and the hostname itself must be recognized by
    the name lookup scheme on the GUI machine.&nbsp; The <a
      href="#Database_Ping_Test">ping test</a> can be used to test the
    hostname.<br>
    <h4>User</h4>
    The user is the username for the DiFX database.&nbsp; This is the
    name you would use when running the a database command line client
    on the DiFX host as in the following example (using a mySQL client):<br>
    <pre>mysql -u USER<br></pre>
    It does not necessarily match the username you may use to log into
    the DiFX host.&nbsp; The database must be set up to recognize this
    user, <span style="font-style: italic;">including access to the
      database from the host where the DiFX GUI is running</span>.&nbsp;
    See <a href="#Database_Remote_Access">Problems with Database Remote
      Access</a> in the trouble-shooting section for details.<br>
    <h4><a name="Port_"></a>Port</h4>
    The JDBC Port is the port over which remote communication with the
    database occurs.&nbsp; The default port for most mySQL installations
    is 3306, so that is probably what you should be setting yours to (if
    you are using the mySQL database management system).&nbsp; Consult
    the <code>/etc/services</code> file on the database host to find
    out which port is being used.<br>
    <h4>Password</h4>
    This is the password for the username in the database.&nbsp; This is
    the password you would use when prompted by the database command
    line client on the database host.&nbsp; This password is set by the
    database administrator or by the user through the database
    client.&nbsp; It is not necessarily the same password you would use
    to log into the database host.<br>
    <span style="font-weight: bold;"><span style="font-weight: bold;"></span></span>
    <h4>DifX Database</h4>
    The DifX Database is the name of the database.&nbsp; At the time of
    this writing the rest of the DiFX software (difxqueue, etc) uses the
    database named "difxdb", so that is the default value for this
    field.&nbsp; Unless you feel you know better, it probably shouldn't
    be changed.&nbsp; <br>
    <h4>Management System</h4>
    <p>The database management system is the "application" used to
      administer and access the DiFX database for your location, such as
      mySQL, Postgresql, etc. (this is sometimes called the database
      "vendor").&nbsp; The management system is set up by your database
      administrator when the DiFX database is initialized (this is all
      done using a management system-specific "schema", as described in
      the database documentation).&nbsp; Management systems known to
      function with the GUI include mySQL and Postgresql.&nbsp; If you
      change the management system you will also have to change the
      driver - see the table below for drivers that are known to work
      with each management system.<br>
    </p>
    <h4>Driver</h4>
    This is the "driver" used by Java to give the GUI access to the
    database.&nbsp; The driver is specific to the database management
    system, and must be something Java has access to.&nbsp; The GUI is
    delivered with drivers appropriate for a couple of popular (and
    free) management systems, as outlined in the table below.<br>
    <meta http-equiv="content-type" content="text/html;
      charset=windows-1252">
    <br>
    <table style="text-align: left; width: 814px; height: 91px;"
      border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top;"><span style="font-weight:
              bold;">Management System</span><br>
          </td>
          <td style="vertical-align: top;"><span style="font-weight:
              bold;">Driver</span><br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">mySQL<br>
          </td>
          <td style="vertical-align: top;">com.mysql.jdbc.Driver<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">Postgresql<br>
          </td>
          <td style="vertical-align: top;">org.postgresql.Driver<br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    If your database installation uses a different management system,
    you may wish to petition the GUI development group to include it.<br>
    <h4>Periodic Update <br>
    </h4>
    This check box tells the Queue Browser to automatically check the
    database for changes after a given time interval, which you can
    set.&nbsp; The usefulness of automatic checking is dependent on
    whether or not other users might be changing the database while you
    are running the GUI.&nbsp; If your GUI instance is the only source
    of database changes it is essentially pointless as all changes you
    make will be recognized anyway.&nbsp; If, on the other hand, other
    users are making changes, the automatic update will make them appear
    in real time (or reasonably close to it if you make your interval
    short).
    <h2><a name="Testing_the_Database_Configuration"></a>Trouble-shooting






























      the Database Configuration</h2>
    A number of things can go wrong when trying to access the DiFX
    database remotely.&nbsp; The Database Configuration panel contains a
    few tests that can be used to troubleshoot the database connection.<br>
    <h3><a name="Database_Ping_Test"></a>Ping Test</h3>
    The Ping Test is run by hitting the "Ping Host" button.&nbsp; It can
    be used to establish two things:<br>
    <ol>
      <li>Can the name for the DiFX host be resolved - i.e. does the
        host name make any sense?</li>
      <li>Is the host reachable with the current network configuration -
        i.e. is it out there?</li>
    </ol>
    The Ping Test performs attempts six "pings" of the named host,
    reporting the results in the results panel.&nbsp; A successful ping
    test will return statistics for each of the pings along with an
    overall statistical summary:<br>
    <br>
    <img style=" width: 476px; height: 196px;" alt=""
      src="images/settings/good_ping_test.gif"><br>
    <br>
    Ping Test failures will produce alarming red text in the results
    panel.&nbsp; The reported failure should give you an idea what is
    wrong.&nbsp; For instance, the following indicates that the given
    hostname cannot be resolved, either by your local host table or by
    your name server:<br>
    <br>
    <img style=" width: 456px; height: 191px;" alt=""
      src="images/settings/bad_hostname_ping_test.gif"><br>
    <br>
    The following screen would indicate a bad network connection at the
    GUI machine:<br>
    <br>
    <img style=" width: 465px; height: 189px;" alt=""
      src="images/settings/bad_network_ping_test.gif"><br>
    <br>
    Finally, the name may be resolved and the network may be good but
    the named host may not answer either because it is down or it is not
    properly connected to the network:<br>
    <br>
    <img style=" width: 501px; height: 186px;" alt=""
      src="images/settings/lost_host_ping_test.gif"><br>
    <br>
    <h3>Database Connection Test</h3>
    The Database Connection Test makes a comprehensive test of the
    current database settings by trying to access the DiFX job queue and
    getting a list of all jobs out of it (this is exactly what the Queue
    Browser does to access the queue data).&nbsp; It is run using the
    "Test Database" button.&nbsp; When run, the test forms a URL out of
    host name and port number (this URL is reported in parenthesis in
    the results panel), then attempts to create a connection using the
    URL, the user, and the password.&nbsp; If this is successful, the
    DiFX database is consulted to obtain a list of all queued
    jobs.&nbsp; The Database Connection Test reports the number of jobs
    in the queue and exits.<br>
    <br>
    <img style=" width: 646px; height: 188px;" alt=""
      src="images/settings/good_database_test.gif"><br>
    <h3><a name="Database_Remote_Access"></a>Problems with Database
      Remote Access</h3>
    The following is a list of some of the errors that might be produced
    by the Database Connection Test and what can be done about
    them.&nbsp; Note that these errors may also be reported in the
    Message Window as the GUI tries to access the DiFX queue in the
    database.<br>
    <code></code> <code></code><code></code><code><br>
      <br>
      <br>
    </code>
    <div style="margin-left: 40px; font-weight: bold;">
      <h6><code>SQLException: Communications link failure The last
          packet sent successfully to the server was 0 milliseconds ago.
          The driver has not received any packets from the server.</code></h6>
    </div>
    <div style="margin-left: 40px;"><br>
    </div>
    This error indicates that the connection to the remote mySQL
    database failed.&nbsp; Check that the DiFX host exits and in on the
    network (using the <a href="#Database_Ping_Test">Ping Test</a>).&nbsp;


























    Then remote log into that host and see if the mySQL server is
    runing:<br>
    <ul style="margin-left: 40px;">
    </ul>
    <pre style="margin-left: 40px;">ps -ef | grep mysql
</pre>
    Both <span style="font-style: italic;">mysql_safe</span> and <span
      style="font-style: italic;">mysqld</span> should be running.&nbsp;
    The latter is the mySQL server, the former is used to start it
    when/if it shuts down.&nbsp; In a proper installation of mySQL these
    programs should be running automatically after boot up.&nbsp; If
    they ARE running, see if a mySQL client can be run (the path may be
    different):<span style="font-family: monospace;"><br>
    </span>
    <div style="margin-left: 40px;">
      <pre><span style="font-family: monospace;"></span>/usr/bin/mysql</pre>
    </div>
    If it cannot be run, this may indicate an incorrect or incomplete
    mySQL installation.<br>
    <br>
    <br>
    <div style="margin-left: 40px; font-weight: bold;">
      <h6><code>SQLException: Access denied for user 'difxw'@'10.1.2.45'
          (using password: YES)</code></h6>
      <h6><code></code></h6>
      <code><br>
      </code></div>
    Access to the database can be denied for a number of reasons.&nbsp;
    Check your user name and password (these need to be mySQL user name
    and password, not necessarily the user name and password you use to
    remotely log into the DiFX host).&nbsp; If you can, run the mySQL
    client on the DiFX host as root from the command line (you will
    require the root password):<br>
    <pre style="margin-left: 40px;">/usr/bin/mysql -u root -p</pre>
    Then generate a list of all users and hosts recognized by mySQL:<br>
    <pre style="margin-left: 40px;">mysql&gt; select user, host from mysql.user;</pre>
    <pre style="margin-left: 40px;">+------+---------------------+<br>| user | host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>+------+---------------------+<br>| difx | 10.1.2.45&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>| difx | 127.0.0.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>| root | 127.0.0.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | localhost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>| difx | localhost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>| root | localhost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | swc02.usno.navy.mil |<br>| difx | swc02.usno.navy.mil |<br>| root | swc02.usno.navy.mil |<br>+------+---------------------+<br>9 rows in set (0.00 sec)</pre>
    In this list somewhere should be the user name you are using paired
    with the GUI host name.&nbsp; Note that mySQL treats user/host pairs
    almost as separate users - you must designate both your user name
    and host as a "user".&nbsp; To do this, the following command will
    both "create" the user/host pair and give it access to all databases
    (note that "grant" is a complex command used for many things - you
    should consult mySQL documentation before using this command with
    reckless abandon):<br>
    <pre style="margin-left: 40px;">mysql&gt; grant all privileges on *.* to 'difx'@'new.host.name';<br>Query OK, 0 rows affected (0.00 sec)</pre>
    You should then see the user/host pair in the user list:<br>
    <pre style="margin-left: 40px;">mysql&gt; select user, host from mysql.user;<br><br>+------+---------------------+<br>| user | host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>+------+---------------------+<br>| difx | 10.1.2.45&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>| difx | 127.0.0.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>| root | 127.0.0.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | localhost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>| difx | localhost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>| root | localhost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>| difx | new.host.name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |   &lt;---------------- HERE!!!!<br>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | swc02.usno.navy.mil |<br>| difx | swc02.usno.navy.mil |<br>| root | swc02.usno.navy.mil |<br>+------+---------------------+<br>10 rows in set (0.00 sec)</pre>
    The user/host pair needs its own password specification - even if
    your user name already had a password, this is not enough!&nbsp; To
    specifiy the password for the new user/host pair (or to make sure
    your password is set properly on an existing user/host pair), do the
    following (replaced "PASSWORD" with your new password):<br>
    <pre style="margin-left: 40px;">mysql&gt; set password for 'difx'@'new.host.name'=password( 'PASSWORD' );<br>Query OK, 0 rows affected (0.00 sec)</pre>
    At this point we reach the limits of my personal mySQL knowledge.<br>
    <br>
    <br>
    <h6> <span style="font-weight: bold; font-family: monospace;">&nbsp;&nbsp;&nbsp;













        Database contains 0 jobs.</span></h6>
    <br>
    This is not an error, however you may encounter this message.&nbsp;
    It simply means there are no jobs queued in the specified
    database.&nbsp; If this is not what you expect (because, for
    instance, you've recently queued something), check the value in the
    "DiFX Database" field.&nbsp; It should match your the name of the
    database where queuing is going on (which is probably "difxdb").<br>
    <br>
  </body>
</html>
